"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4994],{6232:(e,a,s)=>{s.d(a,{A:()=>r});const r=s.p+"assets/images/variablle_flow-e79d697f1b28276778a5b6eae8ec76e7.png"},28453:(e,a,s)=>{s.d(a,{R:()=>n,x:()=>i});var r=s(96540);const o={},t=r.createContext(o);function n(e){const a=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:n(e.components),r.createElement(t.Provider,{value:a},e.children)}},65701:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"how-tos/airflow/use-datacoves-secrets-manager","title":"How to use Datacoves Secrets Manager in Airflow","description":"Datacoves includes a built-in Secrets Manager that allows you to securely store and manage secrets for both administrators and developers. Secrets can be stored at the project or environment level and easily shared across other tools in your stack, ensuring seamless integration and enhanced security. Creating or editing a secret in the Datacoves Secret Manager is straightforward. Be sure to prefix all secrets stored in Datacoves Secrets Manager with datacoves-","source":"@site/docs/how-tos/airflow/use-datacoves-secrets-manager.md","sourceDirName":"how-tos/airflow","slug":"/how-tos/airflow/use-datacoves-secrets-manager","permalink":"/docusaurus-test/docs/how-tos/airflow/use-datacoves-secrets-manager","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/how-tos/airflow/use-datacoves-secrets-manager.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"How to use the Airflow API","permalink":"/docusaurus-test/docs/how-tos/airflow/use-airflow-api"},"next":{"title":"Variables and Connections","permalink":"/docusaurus-test/docs/how-tos/airflow/use-variables-and-connections"}}');var o=s(74848),t=s(28453);const n={},i="How to use Datacoves Secrets Manager in Airflow",c={},l=[{value:"Read variable from Datacoves Secrets manager",id:"read-variable-from-datacoves-secrets-manager",level:2},{value:"The order of places it will look for are as follows:",id:"the-order-of-places-it-will-look-for-are-as-follows",level:3},{value:"Best practices to follow when using a Secrets Manager variable",id:"best-practices-to-follow-when-using-a-secrets-manager-variable",level:3}];function d(e){const a={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.header,{children:(0,o.jsx)(a.h1,{id:"how-to-use-datacoves-secrets-manager-in-airflow",children:"How to use Datacoves Secrets Manager in Airflow"})}),"\n",(0,o.jsxs)(a.p,{children:["Datacoves includes a built-in ",(0,o.jsx)(a.a,{href:"/docusaurus-test/docs/reference/admin-menu/secrets",children:"Secrets Manager"})," that allows you to securely store and manage secrets for both administrators and developers. Secrets can be stored at the project or environment level and easily shared across other tools in your stack, ensuring seamless integration and enhanced security. ",(0,o.jsx)(a.a,{href:"/docusaurus-test/docs/how-tos/datacoves/how_to_secrets",children:"Creating or editing a secret"})," in the Datacoves Secret Manager is straightforward. Be sure to prefix all secrets stored in Datacoves Secrets Manager with ",(0,o.jsx)(a.code,{children:"datacoves-"})]}),"\n",(0,o.jsx)(a.h2,{id:"read-variable-from-datacoves-secrets-manager",children:"Read variable from Datacoves Secrets manager"}),"\n",(0,o.jsxs)(a.p,{children:["Once you save your variable in the Datacoves Secret Manager you are ready to use your variable in a DAG. This is done using ",(0,o.jsx)(a.code,{children:"Variable.get"}),". Airflow will look in several places to find the variable."]}),"\n",(0,o.jsx)(a.h3,{id:"the-order-of-places-it-will-look-for-are-as-follows",children:"The order of places it will look for are as follows:"}),"\n",(0,o.jsxs)(a.ol,{children:["\n",(0,o.jsx)(a.li,{children:"AWS Secrets Manager (If configured)"}),"\n",(0,o.jsx)(a.li,{children:"Datacoves Secrets Manager"}),"\n",(0,o.jsx)(a.li,{children:"Airflow variables"}),"\n"]}),"\n",(0,o.jsx)(a.p,{children:"Once a variable is found Airflow will stop its search."}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"secrets flowchart",src:s(6232).A+"",width:"1560",height:"840"})}),"\n",(0,o.jsx)(a.h3,{id:"best-practices-to-follow-when-using-a-secrets-manager-variable",children:"Best practices to follow when using a Secrets Manager variable"}),"\n",(0,o.jsx)(a.p,{children:"There are some best practices that we recommend when using the Datacoves Secrets manager which will improve performance and cost."}),"\n",(0,o.jsxs)(a.ol,{children:["\n",(0,o.jsxs)(a.li,{children:["Always call your ",(0,o.jsx)(a.code,{children:"Variable.get"})," from within the Datacoves Task Decorators. This ensures the variable is only fetched at runtime."]}),"\n",(0,o.jsxs)(a.li,{children:["Make use of prefixes based on where your variable is stored like ",(0,o.jsx)(a.code,{children:"datacoves-"}),"(Datacoves secrets manager will only search for secrets with this prefix), ",(0,o.jsx)(a.code,{children:"aws_"}),", ",(0,o.jsx)(a.code,{children:"airflow_"})," and so on to help you identify and debug your variables. eg) ",(0,o.jsx)(a.code,{children:"datacoves-mayras_secret"})," seen in the example below."]}),"\n"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'from airflow.decorators import dag, task\nfrom pendulum import datetime\nfrom airflow.models import Variable\n\ndoc = """## Datacoves Bash Decorator DAG\nThis DAG is a sample using the Datacoves decorators with variable calls."""\n\n@dag(\n    default_args={\n        "start_date": datetime(2024, 1, 1),\n        "owner": "Mayra Pena",\n        "email": "Mayra @example.com",\n        "email_on_failure": True,\n    },\n    catchup=False,\n    tags=["version_1"],\n    description="Testing task decorators",\n    schedule_interval="0 0 1 */12 *",\n)\ndef task_decorators_example():\n\n    @task.datacoves_bash\n    def calling_vars_in_decorators() -> str:\n        my_var = Variable.get("datacoves-mayras_secret") # Call variable within @task.datacoves_bash\n        return f"My variable is: {my_var}"\n\n    calling_vars_in_decorator() # Call task function\n\n# Invoke Dag\ndag = task_decorators_example()\ndag.doc_md = doc\n'})}),"\n",(0,o.jsxs)(a.blockquote,{children:["\n",(0,o.jsxs)(a.p,{children:["[!TIP]To auto mask your secret you can use ",(0,o.jsx)(a.code,{children:"secret"})," or ",(0,o.jsx)(a.code,{children:"password"})," in the secret name since this will set ",(0,o.jsx)(a.code,{children:"hide_sensitive_var_conn_fields"})," to True. eg) aws_mayras_password. Please see ",(0,o.jsx)(a.a,{href:"https://www.astronomer.io/docs/learn/airflow-variables#hide-sensitive-information-in-airflow-variables",children:"this documentation"})," for a full list of masking words."]}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);